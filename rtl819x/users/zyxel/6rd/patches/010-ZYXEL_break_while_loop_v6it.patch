--- a/6rdcalc.c	2018-10-09 11:34:31.524908200 +0800
+++ b/6rdcalc.c	2018-12-03 17:48:41.435557056 +0800
@@ -108,6 +108,7 @@
 		v4it++; v6it++;
 	}
 
+	int i=v6it;
 	/* Clear remaining bits. */
 	while (v6it < 128) {
 		byte6 = (unsigned char *)(&v6.s6_addr) + (v6it >> 2);
@@ -116,6 +117,9 @@
 		*byte6 &= ~bit6;
 
 		v6it++;
+		i++;
+		if (i > 127)
+			break;
 	}
 
 	/* Print the subnet prefix. */
